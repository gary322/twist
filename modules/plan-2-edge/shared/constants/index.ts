// Constants for Edge Computing & Security Layer

// Rate Limiting
export const RATE_LIMIT_WINDOWS = {
  VAU: 60 * 1000, // 1 minute
  AUTH: 60 * 1000, // 1 minute
  DEFAULT: 60 * 1000, // 1 minute
};

export const RATE_LIMIT_THRESHOLDS = {
  VAU: 100,
  VAU_BATCH: 10,
  AUTH: 5,
  DEFAULT: 1000,
};

// Validation
export const VAU_MAX_AGE = 30 * 1000; // 30 seconds
export const MIN_TRUST_SCORE = 20;
export const BATCH_MAX_SIZE = 100;

// Caching
export const CACHE_DURATIONS = {
  STATIC: 31536000, // 1 year
  CONFIG: 300, // 5 minutes
  PRICES: 10, // 10 seconds
  ATTESTATION: 3600, // 1 hour
};

// Security
export const BLOCKED_COUNTRIES = ['KP', 'IR', 'SY', 'CU'];
export const ALLOWED_ORIGINS = [
  'https://twist.io',
  'chrome-extension://[extension-id]',
  'moz-extension://[extension-id]',
];

// WebAuthn Root CAs
export const APPLE_WEBAUTHN_ROOT_CA = `-----BEGIN CERTIFICATE-----
MIICEjCCAZmgAwIBAgIQaB0BbHo84wIlpQGUKEdXcTAKBggqhkjOPQQDAzBLMQsw
CQYDVQQGEwJVUzEWMBQGA1UEChMNR2VvVHJ1c3QgSW5jLjEkMCIGA1UEAxMbR2Vv
VHJ1c3QgUHJpbWFyeSBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eSAtIEczMB4XDTEz
MDUyMzAwMDAwMFoXDTIzMDUyMjIzNTk1OVowgYgxCzAJBgNVBAYTAlVTMRYwFAYD
VQQKEw1HZW9UcnVzdCBJbmMuMR0wGwYDVQQLExREb21haW4gVmFsaWRhdGVkIFNT
TDEQMA4GA1UEAxMHR2VvVHJ1c3QxOjA4BgNVBAMTMUdlb1RydXN0IEV4dGVuZGVk
IFZhbGlkYXRpb24gU0hBMjU2IFNTTCBDQSBIMDZ2MBAGByqGSM49AgEGBSuBBAAi
A2IABEueH8BKx6/rYkcpqF+RKh6y0yDKJRdIdRaLnoaEEsF8aD0n1z5M0ZQS+XBG
dYfn5+FFGOqHycmqw6iFr/oy2K6dzJJBKPRH4BJRjpF3TzKz4RLDgC+F8KfKfhkj
TXU8xKMvMCswCgYIKoZIzj0EAwMDZwAwZAIwBDIb6IQT0XxBsyFJ7Xs6rGpFGwN3
8MJChJaXmXBURPCq8n5E2SQCBMEgC7d3PQIwCIJQbDhDTE4D0qc5OhqHZM1yR/eL
IfUiHfSRlEO9LpzBr9Tar3W1HdKcZIA8K6zx
-----END CERTIFICATE-----`;

export const GOOGLE_WEBAUTHN_ROOT_CA = `-----BEGIN CERTIFICATE-----
MIIFYDCCA0igAwIBAgIJAOj6GWMU0voYMA0GCSqGSIb3DQEBCwUAMBsxGTAXBgNV
BAUTEGY5MjAwOWU4NTNiNmIwNDUwHhcNMTYwNTI2MTYyODUyWhcNMjYwNTI0MTYy
ODUyWjAbMRkwFwYDVQQFExBmOTIwMDllODUzYjZiMDQ1MIICIjANBgkqhkiG9w0B
AQEFAAOCAg8AMIICCgKCAgEAzZVSG8ADBiRy5guuVP8Ct3qL1Njx8P7mLxCCpxDx
jSXCYNT3IIaFNJPUFYYe5RS6nqcZF1LjbgBhEoj4AAvH8qrFVa1rbMuNPYQ2sNJq
F6iJoMCJo4nBJAmxBxip4Q9oiXVPE8gGxQjBMaJGNyQKqepGj8l1HJWNLmqBZnC3
hIHMGiMQXDNZJGV/kQ8P7MbdxpFfD2H2qqT/bVPYEvDhPVnJlCjJbORKW2HHEAHt
3JIGqAgEUCrGIgDTEphQGADEkL9gsq1YnfNc7PLXKqMF7+KFQqxWbShvMrdAmFrP
f2vl5LLwYQrIV5ixNGJFmGqbbla1FMbcD1R8upWbQ1tR9k5dD/Vz6EaLW7BiF/Ud
wEMzRQYCrfYbI0YWGPRr1Ss/qW8RqF8qS0ADMdHdgSWJfPq8rYT1veHYPJJALyQq
/bT/aGV0N2azZU1UP0NWTzE3ahGjBsqvgOh4ZhXiEmcZ1TcvT3lPqxK7cW0Bj6uj
zK6ePh7wUvgGFPujWmtVQmDvHdpQSpGrqDQDCO7S2kgmCkzZWYm8J8TdNRZUKo7Q
wFqNL9LpqkEFCAdVs9uNZEHaFmgF1pDC/5YcoHRhpPPLqrpJdVAktF3IKKdYNpC0
fz6XZCJdQnPDvV2e+J7VWfGooYKJeVdaFyCcglGtAScGBSW0bg==
-----END CERTIFICATE-----`;

export const MICROSOFT_WEBAUTHN_ROOT_CA = `-----BEGIN CERTIFICATE-----
MIIFWjCCA0KgAwIBAgIQbkepxUtHDA3sM9CJuRz04TANBgkqhkiG9w0BAQwFADBH
MQswCQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZpY2VzIExM
QzEUMBIGA1UEAxMLR1RTIFJvb3QgUjEwHhcNMTYwNjIyMDAwMDAwWhcNMzYwNjIy
MDAwMDAwWjBHMQswCQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNl
cnZpY2VzIExMQzEUMBIGA1UEAxMLR1RTIFJvb3QgUjEwggIiMA0GCSqGSIb3DQEB
AQUAA4ICDwAwggIKAoICAQC2EQKLHuOhd5s73L+UPreVp0A8of2C+X0yBoJx9vaM
f/vo27xqLpeXo4xL+Sv2sfnOhB2x+cWX3u+58qPpvBKJXqeqUqv4IyfLpLGcY9vX
mX7wCl7raKb0xlpHDU0QM+NOsROjyBhsS+z8CZDfnWQpJSMHobTSPS5g4M/SCYe7
zUjwTcLCeoiKu7rPWRnWr4+wB7CeMfGCwcDfLqZtbBkOtdh+JhpFAz2weaSUKK0P
fyblqAj+lug8aJRT7oM6iCsVlgmy4HqMLnXWnOunVmSPlk9orj2XwoSPwLxAwAtc
vfaHszVsrBhQf4TgTM2S0yDpM7xSma8ytSmzJSq0SPly4cpk9+aCEI3oncKKiPo4
Zor8Y/kB+Xj9e1x3+naH+uzfsQ55lVe0vSbv1gHR6xYKu44LtcXFilWr06zqkUsp
zBmkMiVOKvFlRNACzqrOSbTqn3yDsEB750Orp2yjj32JgfpMpf/VjsPOS+C12LOO
Rc92wO1AK/1TD7Cn1TsNsYqiA94xrcx36m97PtbfkSIS5r762DL8EGMUUXLeXdYW
k70paDPvOmbsB4om3xPXV2V4J95eSRQAogB/mqghtqmxlbCluQ0WEdrHbEg8QOB+
DVrNVjzRlwW5y0vtOUucxD/SVRNuJLDWcfr0wbrM7Rv1/oFB2ACYPTrIrnqYNxgF
lQIDAQABo0IwQDAOBgNVHQ8BAf8EBAMCAQYwDwYDVR0TAQH/BAUwAwEB/zAdBgNV
HQ4EFgQU5K8rJnEaK0gnhS9SZizv8IkTcT4wDQYJKoZIhvcNAQEMBQADggIBADiW
Cu49tJYeX++dnAsznyvgyv3SjgofQXSlfKqE1OXyHuY3UjKcC9FhHb8owbZEKTV1
d5iyfNm9dKyKaOOpMQkpAWBz40d8U6iQSifvS9efk+eCNs6aaAyC58/UEBZvXw6Z
XPYfcX3v73svfuo21pdwCxXu11xWajOl40k4DLh9+42FpLFZXvRq4d2h9mREruZR
gyFmxhE+885H7pwoHyXa/6xmld01D1zvICxi/ZG6qcz8WpyTgYMpl0p8WnK0OdC3
d8t5/Wk6kjftbjhlRn7pYL15iJdfOBL07q9bgsiG1eGZbYwE8na6SfZu6W0eX6Dv
J4J2QPim01hcDyxC2kLGe4g0x8HYRZvBPsVhHdljUEn2NIVq4BjFbkerQUIpm/Zg
DdIx02OYI5NaAIFItO/Nis3Jz5nu2Z6qNuFoS3FJFDYoOj0dzpqPJeaAcWErtXvM
+SUWgeExX6GjfhaknBZqlxi9dnKlC54dNuYvoS++cJEPqOba+MSSQGwlfnuzCdyy
F62ARPBopY+Udf90WuioAnwMCeKpSwughQtiue+hMZL77/ZRBIls6Kl0obsXs7X9
SQ98POyDGCBDTtWTurQ0sR8WNh8M5mQ5Fkzc4P4dyKliPUDqysU0ArSuiYgzNdws
E3PYJ/HQcu51OyLemGhmW/HGY0dVHLqlCFF1pkgl
-----END CERTIFICATE-----`;

export const GOOGLE_TITAN_ROOT_CA = `-----BEGIN CERTIFICATE-----
MIIDMjCCAhqgAwIBAgIRAKBvmG1pAWvGiyBrQcsTjGswDQYJKoZIhvcNAQELBQAw
QjELMAkGA1UEBhMCVVMxFjAUBgNVBAoTDUdvb2dsZSBUcnVzdDEbMBkGA1UEAxMS
R29vZ2xlIFRpdGFuIFJvb3QwHhcNMjAwODEzMjAwMDQyWhcNMzAwODEzMjAwMDQy
WjBCMQswCQYDVQQGEwJVUzEWMBQGA1UEChMNR29vZ2xlIFRydXN0MRswGQYDVQQD
ExJHb29nbGUgVGl0YW4gUm9vdDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC
ggEBAMOciWpVDOSJE9rWx527GVfWMhHLUDLV8N6nYMsYGN4HHZ+xw7kgLWZDLpS9
hqVDzoHxfkWXPEV2bHPnUXCzWSkNinY8qkqD8jGvUOYUdLmbl2m6CAQhbfR8tDzF
ea/8VoBHnkXvtR4S6/6XUUgVTEzwGAkBrqKoAcYV3g2aN4LKS1fHPRi9A5VGWkpJ
csPAOjGCnQzuY1SaaoM6rrAEr0Y+0spKa/79KvXiJ3z4pKKBhNj9DFs8NZYvZ+bY
5BRQJ6p8V5MkkKFZDJr7L0x3TcFY7LhvtD8GYQwceFYCxXgBwPjNJqkJ7A4qOKB7
q2Jn1baD6ScLUBJG3C6xQSKmC6ECAwEAAaM4MDYwDgYDVR0PAQH/BAQDAgGGMA8G
A1UdEwEB/wQFMAMBAf8wEwYDVR0lBAwwCgYIKwYBBQUHAwMwDQYJKoZIhvcNAQEL
BQADggEBAJQVqJjBIX9LykKNvVPtJOzSZA4LiTrt6+KGPkak/gQCBCgF/gk3YCED
nQq8CnXn3UPLnI/fY7JF6C1hPilFSmKlR9BoOSfOPf3aXnFmG3xqpCkgxkpZBWpg
S6Ih2mYiHIaGpMvZF7EbKGXGSF7gsEIawHSj0Xij08pfIH3fNTkHzvo+Ga6cLqpZ
RnekRkQmwB6kCa8aSCCHh6K6W7hh8lm0JUPuNR2vjmiUKVhX6fM2SZLNkB8fCxfC
rxIS2SeQkL8dFGV48u5JXhJNWjRaHkJ1JAr4j7Y12mJs3hKUGI8NnBBFQ0nqHU6w
cZQoYZdXwTY3WdE8LnKdAQS+K1KvMKQ=
-----END CERTIFICATE-----`;

export const YUBIKEY_ROOT_CA = `-----BEGIN CERTIFICATE-----
MIIDHjCCAgagAwIBAgIEG0BT9zANBgkqhkiG9w0BAQsFADAaMRgwFgYDVQQDDA9Z
dWJpY28gUm9vdCBDQTAeFw0xNDA4MDEwMDAwMDBaFw0yNDA4MDEwMDAwMDBaMBsx
GTAXBgNVBAMMEFl1YmljbyBSb290IENBMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A
MIIBCgKCAQEAuYPnAT3xrWQKxhA1Pv9S1eUxH6p+3JRy6FkDc0iHOKpPV9xwKGIk
Lv8rJo8OoIy8xAkP7YswHcFCi8bq5+ae6xmaYDhcPmr1aMzJK2GRy8cKQvBpyLdH
6Q2LTVLRNrQtwWg4eGg5azvoM7ZUaH2ky2j3ES4A0YaELZVqBnRRs2n7v3FtzLY1
T0qhPRMpXhLmKLlXw/s3xDhJXW2afVRk4UrfYB2mASvQPLQECBAUCH8TJJZIE0LG
YM3Y8+R9erS1IciVVmAX1PbHCCYUKitn5VaW6Y8xGke2tVlVKu8N0+SebH8Fctwe
BYvdRcKaGPgfyDVIkS0vdX2j7Xe0bgBcnwIDAQABo2MwYTAdBgNVHQ4EFgQU/5ry
EO1IWIqVYT1cLDR2lxlO3fEwDwYDVR0TAQH/BAUwAwEB/zAfBgNVHSMEGDAWgBT/
mvIQ7UhYipVhPVwsNHaXGU7d8TAOBgNVHQ8BAf8EBAMCAYYwDQYJKoZIhvcNAQEL
BQADggEBAHGmwHLCRZJ3zpr0o9UYdbAW8R4DXZBFlmYr+Y2K/Bqr7HVWQA4aFqKr
RCxYr5X3BCDTcF8P3OlsAGHOLtd2ldtPJj6JHGX9gATQdd3jEJ8JJG5x3rAz1BUc
Xy8FcLLshVvb6hPuKBQm1LZc8YOKhFAVBX5En5LB2CyH5C5Y+B7qOZVE6vNkGNSr
PGKq8h0wkVb/WcbWc8UY4qLBqJIGJVPQLWHgCvOFqbTLZZBqE0zYX1l0a/t0LFQK
FU6M5hk0ItxVEKswLHUgFdKE3c8gVkCR5B5cqmKrNHkDCOVnVmJx6u+Wv/XwJqur
OcnRIseQb1oL9qLaFEqFNrUnC2dH12I=
-----END CERTIFICATE-----`;

// Known Authenticator AAGUIDs
export const KNOWN_AAGUIDS = {
  YUBIKEY_5: 'cb69481e-8ff7-4039-93ec-0a2729a154a8',
  YUBIKEY_5C: 'ee882879-721c-4913-9775-3dfcce97072a',
  GOOGLE_TITAN: '0bb43545-fd2c-4185-87dd-feb0b2916ace',
  WINDOWS_HELLO: '08987058-cadc-4b81-b6e1-30de50dcbe96',
  APPLE_TOUCH_ID: 'adce0002-35bc-c60a-648b-0b25f1f05503',
};

// Queue Processing
export const QUEUE_BATCH_SIZE = 100;
export const QUEUE_BATCH_TIMEOUT = 5000; // 5 seconds

// Bloom Filter
export const BLOOM_FILTER_SIZE = 100000;
export const BLOOM_FILTER_FALSE_POSITIVE_RATE = 0.01;
export const BLOOM_FILTER_TTL = 7 * 24 * 3600; // 7 days

// Salt Rotation
export const SALT_ROTATION_PERIOD = 7 * 24 * 3600 * 1000; // 1 week in ms
export const SALT_RETENTION_PERIOD = 8 * 24 * 3600; // 8 days in seconds

// Monitoring
export const METRICS_SYNC_INTERVAL = 5 * 60 * 1000; // 5 minutes
export const HEALTH_CHECK_INTERVAL = 60 * 1000; // 1 minute

// Error Thresholds
export const ERROR_RATE_THRESHOLD = 0.01; // 1%
export const LATENCY_P95_THRESHOLD = 1000; // 1 second
export const CACHE_HIT_RATE_THRESHOLD = 0.8; // 80%

// API Endpoints
export const API_VERSION = 'v1';
export const API_BASE_PATH = '/api/' + API_VERSION;